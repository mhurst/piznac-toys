const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

// Transformers G1 accessories by figure name
// Format: "Figure Name": ["accessory1", "accessory2", ...]
const TF_ACCESSORIES = {
  // 1984
  "Optimus Prime": ["Laser Rifle", "Fists (L)", "Fists (R)", "Fuel Pump", "Hose", "Roller", "Nozzle"],
  "Megatron": ["Fusion Cannon", "Silencer", "Stock", "Telescopic Sight", "Sword"],
  "Starscream": ["Laser Rifle (L)", "Laser Rifle (R)", "Fists (L)", "Fists (R)", "Wing Missiles (L)", "Wing Missiles (R)"],
  "Skywarp": ["Laser Rifle (L)", "Laser Rifle (R)", "Fists (L)", "Fists (R)", "Wing Missiles (L)", "Wing Missiles (R)"],
  "Thundercracker": ["Laser Rifle (L)", "Laser Rifle (R)", "Fists (L)", "Fists (R)", "Wing Missiles (L)", "Wing Missiles (R)"],
  "Soundwave": ["Laser Rifle", "Buzzsaw"],
  "Buzzsaw": [],
  "Laserbeak": [],
  "Ravage": [],
  "Rumble": ["Laser Pistols (L)", "Laser Pistols (R)"],
  "Frenzy": ["Laser Pistols (L)", "Laser Pistols (R)"],
  "Jazz": ["Laser Rifle"],
  "Prowl": ["Launcher", "Missiles (x3)", "Shoulder Cannon"],
  "Bluestreak": ["Launcher", "Missiles (x3)", "Shoulder Cannon"],
  "Sideswipe": ["Rocket Pack", "Flare Gun"],
  "Sunstreaker": ["Rocket Pack"],
  "Ironhide": ["Launcher", "Missile"],
  "Ratchet": ["Launcher", "Missile"],
  "Mirage": ["Launcher", "Missile"],
  "Hound": ["Laser Rifle", "Missile Launcher", "Missiles (x3)", "Spare Tire", "Hologram Gun"],
  "Trailbreaker": ["Launcher", "Missile"],
  "Wheeljack": ["Launcher", "Missile"],
  "Bumblebee": [],
  "Cliffjumper": [],
  "Brawn": [],
  "Gears": [],
  "Huffer": [],
  "Windcharger": [],

  // 1985
  "Grimlock": ["Sword", "Laser Rifle", "Rocket Launcher"],
  "Slag": ["Sword", "Laser Rifle", "Rocket Launcher"],
  "Sludge": ["Sword", "Laser Rifle", "Rocket Launcher"],
  "Snarl": ["Sword", "Laser Rifle", "Rocket Launcher"],
  "Swoop": ["Sword", "Laser Rifle", "Missile Launcher"],
  "Jetfire": ["Armor Chest Plate", "Armor Wing Clip (L)", "Armor Wing Clip (R)", "Laser Rifle", "Small Guns (x4)"],
  "Omega Supreme": ["Backpack", "Claw"],
  "Perceptor": ["Missile", "Missile Launcher"],
  "Blaster": ["Laser Rifle"],
  "Eject": [],
  "Ramhorn": [],
  "Rewind": [],
  "Steeljaw": [],
  "Grapple": ["Launcher", "Missile"],
  "Hoist": ["Launcher", "Missile", "Fists (L)", "Fists (R)"],
  "Inferno": ["Launcher", "Missile"],
  "Red Alert": ["Launcher", "Missile"],
  "Skids": ["Launcher", "Missile", "Electron Blaster"],
  "Smokescreen": ["Launcher", "Missiles (x3)", "Shoulder Cannon"],
  "Tracks": ["Launcher", "Missile", "Black Wing (L)", "Black Wing (R)"],
  "Beachcomber": [],
  "Cosmos": [],
  "Powerglide": [],
  "Seaspray": [],
  "Warpath": [],
  "Roadbuster": ["Laser Rifle", "Linear Blaster Gun", "Assault Rifle"],
  "Whirl": ["Laser Rifle", "Missile Launcher", "Missiles (x4)", "Sword"],
  "Topspin": ["Gun (L)", "Gun (R)"],
  "Twin Twist": ["Gun (L)", "Gun (R)"],
  "Shockwave": ["Hose"],
  "Silverbolt": ["Laser Rifle"],
  "Air Raid": ["Laser Rifle"],
  "Fireflight": ["Laser Rifle"],
  "Skydive": ["Laser Rifle"],
  "Slingshot": ["Laser Rifle"],
  "Motormaster": ["Sword", "Cyclone Gun", "Menasor Parts"],
  "Dead End": ["Exhaust Pipe Rifle"],
  "Breakdown": ["Exhaust Pipe Rifle"],
  "Drag Strip": ["Graviton Rifle"],
  "Wildrider": ["Scatter Shot Gun"],
  "Astrotrain": ["Ionic Displacer Rifle"],
  "Blitzwing": ["Electron Scimitar", "Gyro-Blaster Rifle"],
  "Bombshell": [],
  "Kickback": [],
  "Shrapnel": [],
  "Dirge": ["Laser Rifle (L)", "Laser Rifle (R)", "Fists (L)", "Fists (R)"],
  "Thrust": ["Laser Rifle (L)", "Laser Rifle (R)", "Fists (L)", "Fists (R)"],
  "Ramjet": ["Laser Rifle (L)", "Laser Rifle (R)", "Fists (L)", "Fists (R)"],
  "Bonecrusher": ["Laser Pistol"],
  "Hook": ["Laser Pistol"],
  "Long Haul": ["Laser Pistol"],
  "Mixmaster": ["Laser Pistol"],
  "Scavenger": ["Laser Pistol"],
  "Scrapper": ["Laser Pistol", "Wing"],
  "Reflector": [],

  // 1986
  "Hot Rod": ["Laser Rifle (L)", "Laser Rifle (R)", "Exhaust Pipes"],
  "Kup": ["Laser Musket", "Drill"],
  "Blurr": ["Laser Rifle", "Shield"],
  "Springer": ["Laser Rifle", "Sword"],
  "Wheelie": ["Laser Rifle"],
  "Wreck-Gar": ["Laser Rifle"],
  "Rodimus Prime": ["Laser Rifle", "Photon Eliminator"],
  "Galvatron": ["Laser Rifle", "Particle Cannon"],
  "Cyclonus": ["Oxidizing Laser"],
  "Scourge": ["Laser Blaster"],
  "Gnaw": [],
  "Broadside": ["Vibro-Axe", "Laser Rifle"],
  "Sandstorm": ["Laser Rifle"],
  "Octane": ["Laser Rifle"],
  "Runabout": ["Laser Rifle"],
  "Runamuck": ["Laser Rifle"],
  "Metroplex": ["Laser Rifle", "Slammer", "Scamper", "Six-Gun"],
  "Trypticon": ["Brunt", "Full-Tilt"],
  "Sky Lynx": [],
  "Hot Spot": ["Fireball Cannons (L)", "Fireball Cannons (R)", "Defensor Parts"],
  "Blades": ["Laser Rifle"],
  "First Aid": ["Laser Rifle"],
  "Groove": ["Laser Rifle (L)", "Laser Rifle (R)"],
  "Streetwise": ["Laser Rifle"],
  "Onslaught": ["Laser Rifle", "Missile Launcher", "Bruticus Parts"],
  "Blast Off": ["Laser Rifle"],
  "Brawl": ["Laser Rifle"],
  "Swindle": ["Laser Rifle"],
  "Vortex": ["Laser Rifle"],
  "Razorclaw": ["Sword", "Sonic Sword", "Predaking Parts"],
  "Divebomb": ["Laser Rifle (L)", "Laser Rifle (R)", "Sword"],
  "Headstrong": ["Laser Rifle"],
  "Rampage": ["Laser Rifle"],
  "Tantrum": ["Laser Rifle"],
  "Outback": [],
  "Pipes": [],
  "Swerve": [],
  "Tailgate": [],
  "Hubcap": [],
  "Ratbat": [],

  // 1987
  "Fortress Maximus": ["Cerebros", "Spike", "Laser Rifle", "Dual Laser Rifle", "Photon Rifle", "Master Sword", "Radar Array (L)", "Radar Array (R)", "Ramp", "Communications Dish"],
  "Scorponok": ["Lord Zarak", "Fasttrack", "Laser Rifle", "Tail Shield", "Antenna (L)", "Antenna (R)"],
  "Chromedome": ["Stylor", "Laser Rifles (L)", "Laser Rifles (R)"],
  "Hardhead": ["Duros", "Shattershot Laser Cannon"],
  "Highbrow": ["Gort", "Laser Rifles (L)", "Laser Rifles (R)"],
  "Brainstorm": ["Arcana", "Photon Pulse Cannons (L)", "Photon Pulse Cannons (R)"],
  "Mindwipe": ["Vorath", "Shield"],
  "Skullcruncher": ["Grax", "Tail/Rifle"],
  "Weirdwolf": ["Monzo", "Sword"],
  "Apeface": ["Spasma"],
  "Snapdragon": ["Krunk", "Laser Rifle"],
  "Sixshot": ["Laser Rifles (L)", "Laser Rifles (R)"],
  "Pointblank": ["Peacemaker"],
  "Sureshot": ["Spoilsport"],
  "Crosshairs": ["Pinpointer"],
  "Misfire": ["Aimless"],
  "Slugslinger": ["Caliburst"],
  "Triggerhappy": ["Blowpipe"],
  "Lightspeed": ["Laser Rifle"],
  "Nosecone": ["Laser Rifle"],
  "Afterburner": ["Laser Rifle"],
  "Strafe": ["Laser Rifle"],
  "Scattershot": ["Laser Rifle", "Computron Parts"],
  "Hun-Gurrr": ["Abominus Parts"],
  "Blot": ["Slime Gun"],
  "Cutthroat": ["Laser Rifle"],
  "Rippersnapper": ["Cyclone Gun"],
  "Sinnertwin": ["Laser Rifle (L)", "Laser Rifle (R)"],
  "Goldbug": [],
  "Chase": [],
  "Freeway": [],
  "Rollbar": [],
  "Searchlight": [],
  "Wideload": [],
  "Doublecross": ["Laser Rifle"],
  "Grotusque": ["Laser Rifle"],
  "Repugnus": ["Laser Rifle"],
  "Cloudraker": ["Laser Rifle (L)", "Laser Rifle (R)"],
  "Fastlane": ["Laser Rifle (L)", "Laser Rifle (R)"],
  "Pounce": [],
  "Wingspan": [],
  "Battletrap": [],
  "Flywheels": [],
  "Slugfest": [],
  "Overkill": [],
  "Beastbox": [],
  "Squawktalk": [],

  // 1988
  "Powermaster Optimus Prime": ["Hi-Q", "Laser Rifle"],
  "Getaway": ["Rev"],
  "Joyride": ["Hotwire"],
  "Slapdash": ["Lube"],
  "Darkwing": ["Throttle"],
  "Dreadwind": ["Hi-Test"],
  "Doubledealer": ["Knok", "Skar", "Missile Launcher", "Missiles (x2)"],
  "Nightbeat": ["Muzzle"],
  "Hosehead": ["Lug"],
  "Siren": ["Quig"],
  "Fangry": ["Brisko"],
  "Squeezeplay": ["Lokos"],
  "Horri-Bull": ["Kreb"],
  "Quickmix": ["Ricochet"],
  "Landfill": ["Silencer", "Flintlock"],
  "Scoop": ["Tracer", "Holepunch"],
  "Needlenose": ["Sunbeam", "Zigzag"],
  "Quake": ["Tiptop", "Heater"],
  "Spinister": ["Singe", "Hairsplitter"],
  "Landmine": ["Laser Rifle", "Pretender Shell"],
  "Cloudburst": ["Laser Rifle", "Pretender Shell"],
  "Waverider": ["Laser Rifle", "Pretender Shell"],
  "Sky High": ["Laser Rifle", "Pretender Shell"],
  "Splashdown": ["Laser Rifle", "Pretender Shell"],
  "Groundbreaker": ["Laser Rifle", "Pretender Shell"],
  "Bomb-Burst": ["Laser Rifle", "Pretender Shell"],
  "Skullgrin": ["Laser Rifle", "Pretender Shell"],
  "Submarauder": ["Laser Rifle", "Pretender Shell"],
  "Bugly": ["Laser Rifle", "Pretender Shell"],
  "Finback": ["Laser Rifle", "Pretender Shell"],
  "Iguanus": ["Laser Rifle", "Pretender Shell"],
  "Carnivac": ["Laser Rifle", "Pretender Shell"],
  "Catilla": ["Laser Rifle", "Pretender Shell"],
  "Chainclaw": ["Laser Rifle", "Pretender Shell"],
  "Snarler": ["Laser Rifle", "Pretender Shell"],
  "Gunrunner": ["Laser Rifle", "Pretender Shell"],
  "Roadgrabber": ["Laser Rifle", "Pretender Shell"],
  "Snaptrap": ["Laser Rifle", "Sword", "Piranacon Parts"],
  "Nautilator": ["Laser Rifle"],
  "Overbite": ["Laser Rifle"],
  "Seawing": ["Laser Rifle"],
  "Skalor": ["Laser Rifle"],
  "Tentakil": ["Laser Rifle"],
  "Cindersaur": [],
  "Flamefeather": [],
  "Sparkstalker": [],
  "Backstreet": [],
  "Dogfight": [],
  "Override": [],
  "Crankcase": [],
  "Ruckus": [],
  "Windsweeper": [],

  // 1989
  "Pretender Bumblebee": ["Laser Rifle", "Pretender Shell"],
  "Pretender Jazz": ["Laser Rifle", "Pretender Shell"],
  "Pretender Grimlock": ["Laser Rifle", "Pretender Shell"],
  "Pretender Starscream": ["Laser Rifle", "Pretender Shell"],
  "Longtooth": ["Laser Rifle", "Pretender Shell"],
  "Pincher": ["Laser Rifle", "Pretender Shell"],
  "Doubleheader": ["Laser Rifle", "Pretender Shell"],
  "Bludgeon": ["Laser Rifle", "Sword", "Pretender Shell"],
  "Octopunch": ["Laser Rifle", "Pretender Shell"],
  "Stranglehold": ["Laser Rifle", "Pretender Shell"],
  "Thunderwing": ["Laser Rifle", "Pretender Shell"],
  "Crossblades": ["Laser Rifle", "Pretender Shell"],
  "Skyhammer": ["Laser Rifle", "Pretender Shell"],
  "Roadblock": ["Laser Rifle", "Pretender Shell"],
  "Vroom": ["Laser Rifle", "Pretender Shell"],
  "Countdown": ["Laser Rifle", "Base/Rocket"],
  "Groundshaker": ["Laser Rifle"],
  "Skystalker": ["Laser Rifle"],
  "Skyhopper": ["Laser Rifle"],
  "Overload": ["Laser Rifle"],
  "Flattop": ["Laser Rifle"],
  "Roughstuff": ["Laser Rifle"],
  "Erector": ["Laser Rifle"],
  "Greasepit": ["Laser Rifle"],
  "Ironworks": ["Laser Rifle"],
  "Airwave": ["Laser Rifle"],
  "Icepick": [],
  "Bristleback": [],
  "Scowl": [],
  "Slog": [],
  "Birdbrain": [],
  "Wildfly": [],
  "Big Shot": [],
  "Flak": [],
  "Tote": [],
  "Fixit": [],
  "Red Hot": [],
  "Seawatch": [],
  "Stakeout": [],
  "Blackjack": [],
  "Detour": [],
  "Hyperdrive": [],
  "Roadhugger": [],
  "Free Wheeler": [],
  "Highjump": [],
  "Mudslinger": [],
  "Powertrain": [],
  "Sidetrack": [],
  "Sunrunner": [],
  "Tailspin": [],
  "Roadhandler": [],
  "Swindler": [],
  "Storm Cloud": [],
  "Nightflight": [],
  "Tailwind": [],
  "Whisper": [],

  // 1990 Action Masters
  "Action Master Blaster": ["Flight Pack"],
  "Action Master Bumblebee": ["Heli-Pack"],
  "Action Master Devastator": ["Scorpulator"],
  "Action Master Grimlock": ["Anti-Tank Cannon"],
  "Action Master Inferno": ["Hydro-Pack"],
  "Action Master Jazz": ["Turbo Board"],
  "Action Master Megatron": ["Neutro-Fusion Tank"],
  "Action Master Prowl": ["Turbo Cycle"],
  "Action Master Shockwave": ["Fistfight"],
  "Action Master Snarl": ["Tyrannitron"],
  "Action Master Soundwave": ["Wingthing"],
  "Action Master Starscream": ["Turbo Jet"],
  "Action Master Wheeljack": ["Turbo Racer"],
  "Axer": ["Off-Road Cycle"],
  "Banzai-Tron": ["Razor-Sharp"],
  "Krok": ["Gatoraider"],
  "Jackpot": ["Sights"],
  "Kick-Off": ["Turbo Pack"],
  "Mainframe": ["Push-Button"],
  "Over-Run": ["Attack Copter"],
  "Rad": ["Lionizer"],
  "Rollout": ["Glitch"],
  "Skyfall": ["Top-Heavy"],
  "Sprocket": ["Attack Cruiser"],
  "Tread Bolt": ["Catgut"],
  "Treadshot": ["Catgut"],
  "Gutcruncher": ["Stratotronic Jet"],
  "Armored Convoy with Optimus Prime": ["Optimus Prime Figure"],

  // 1990 Micromasters
  "Big Daddy": [],
  "Big Hauler": [],
  "Crumble": [],
  "Greaser": [],
  "Ground Hog": [],
  "Groundpounder": [],
  "Hubs": [],
  "Heavy Tread": [],
  "Hydraulic": [],
  "Neutro": [],
  "Slow Poke": [],
  "Trip-Up": [],
  "Barrage": [],
  "Blast Master": [],
  "Heave": [],
  "Moonrock": [],
  "Phaser": [],
  "Tracer": [],
  "Direct-Hit": [],
  "Fireshot": [],
  "Half-Track": [],
  "Meltdown": [],
  "Power Punch": [],
  "Vanquish": [],
  "Barricade": [],
  "Bombshock": [],
  "Dropshot": [],
  "Growl": [],
  "Motorhead": [],
  "Roller Force": [],
  "Blaze Master": [],
  "Eagle Eye": [],
  "Missile Master": [],
  "Power Run": [],
  "Roadburner": [],
  "Strikedown": [],
  "Oiler": [],
  "Slide": [],
  "Wheel Blaze": [],
  "Hammer": [],
  "Knockout": [],
  "Sledge": [],
  "Stonecruncher": [],
  "Excavator": [],
  "Grit": [],
  "Takedown": [],
};

// Masters of the Universe accessories
const MOTU_ACCESSORIES = {
  "He-Man": ["Power Sword", "Shield", "Battle Axe"],
  "Skeletor": ["Havoc Staff", "Power Sword (purple half)"],
  "Man-At-Arms": ["Mace", "Shield"],
  "Teela": ["Staff", "Shield", "Snake Armor"],
  "Beast Man": ["Whip", "Armor"],
  "Stratos": ["Wings", "Jetpack"],
  "Mer-Man": ["Sword", "Armor"],
  "Zodac": ["Gun"],
  "Man-E-Faces": ["Laser Pistol"],
  "Ram Man": [],
  "Trap Jaw": ["Arm Attachments (Hook)", "Arm Attachments (Laser)", "Arm Attachments (Claw)", "Belt"],
  "Tri-Klops": ["Sword"],
  "Evil-Lyn": ["Staff", "Shield"],
  "Faker": ["Power Sword (orange)", "Shield (orange)"],
  "Battle Armor He-Man": ["Power Sword", "Shield", "Battle Axe"],
  "Battle Armor Skeletor": ["Havoc Staff", "Power Sword (purple half)"],
  "Buzz-Off": ["Axe", "Wings", "Helmet"],
  "Fisto": ["Sword"],
  "Mekaneck": ["Club"],
  "Orko": ["Wand", "Coin", "Pull-String"],
  "Prince Adam": ["Power Sword"],
  "Clawful": ["Mace", "Shield"],
  "Jitsu": ["Sword"],
  "Kobra Khan": [],
  "Webstor": ["Grappling Hook", "Gun", "Backpack"],
  "Whiplash": ["Spear"],
  "Thunder Punch He-Man": ["Power Sword", "Shield", "Caps"],
  "Moss Man": [],
  "Roboto": ["Axe", "Interchangeable Hands (x3)"],
  "Sy-Klone": ["Shield", "Laser Rifle"],
  "Dragon Blaster Skeletor": ["Havoc Staff", "Dragon"],
  "Spikor": ["Mace", "Trident"],
  "Stinkor": ["Shield", "Gun"],
  "Two-Bad": ["Sword", "Shield"],
  "Grizzlor": ["Crossbow"],
  "Hordak": ["Crossbow", "Shield"],
  "Leech": [],
  "Mantenna": [],
  "Modulok": [],
  "Flying Fists He-Man": ["Shield", "Sword"],
  "Extendar": ["Shield"],
  "Rio Blast": [],
  "Rokkon": [],
  "Snout Spout": ["Axe"],
  "Stonedar": [],
  "Terror Claws Skeletor": ["Armor"],
  "Dragstor": ["Ripcord", "Crossbow"],
  "Hurricane Hordak": ["Shield", "Bat"],
  "Horde Trooper": ["Crossbow", "Armor"],
  "King Hiss": ["Shield", "Staff"],
  "Multi-Bot": [],
  "Rattlor": ["Staff"],
  "Tung Lashor": [],
  "Clamp Champ": ["Clamp"],
  "King Randor": ["Scepter", "Staff"],
  "Sorceress": ["Wings", "Staff"],
  "Rotar": [],
  "Twistoid": [],
  "Ninjor": ["Sword", "Nunchucks", "Bow"],
  "Scare Glow": ["Halberd"],
  "Blade": ["Swords (x3)"],
  "Blast-Attak": [],
  "Mosquitor": [],
  "Snake Face": ["Staff", "Shield"],
  "Sssqueeze": [],
  "Gwildor": ["Cosmic Key"],
  "Saurod": ["Gun"],
  "Laser Light Skeletor": ["Staff"],
  "Laser Power He-Man": ["Sword", "Shield"],
  "Buzz-Saw Hordak": [],
  "Megator": ["Mace"],
  "Tytus": ["Sword", "Shield"],
};

async function main() {
  let totalCreated = 0;

  const allAccessories = { ...TF_ACCESSORIES, ...MOTU_ACCESSORIES };

  for (const [figureName, accessories] of Object.entries(allAccessories)) {
    if (accessories.length === 0) continue;

    const figures = await prisma.figure.findMany({
      where: { name: figureName },
      select: { id: true, name: true },
    });

    if (figures.length === 0) {
      console.log(`WARNING: Figure not found: "${figureName}"`);
      continue;
    }

    // If multiple matches (e.g. "Sky High" appears twice), add to all
    for (const figure of figures) {
      for (const accName of accessories) {
        try {
          await prisma.accessory.create({
            data: {
              name: accName,
              figureId: figure.id,
            },
          });
          totalCreated++;
        } catch (err) {
          if (err.code === 'P2002') {
            console.log(`  SKIP duplicate: ${figure.name} - ${accName}`);
          } else {
            throw err;
          }
        }
      }
      console.log(`+ ${figure.name} (${figure.id}): ${accessories.length} accessories`);
    }
  }

  console.log(`\nDone! Created ${totalCreated} accessories.`);
  await prisma.$disconnect();
}

main().catch((err) => {
  console.error(err);
  prisma.$disconnect();
  process.exit(1);
});
